<!DOCTYPE html>
<html lang="en">

<!--
/////////////////////////////////////////////////////////////////////////////
INLINE VERSION - All CSS and JavaScript embedded
Optimized for Squarespace Code Block
/////////////////////////////////////////////////////////////////////////////
-->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Reality Honolulu | Sermon Library</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Inline CSS -->
    <style>
/* Reset and container */
.sermon-library-container {
  width: 100%;
  max-width: 1400px;
  margin: 0 auto;
  padding: 20px;
  box-sizing: border-box;
}

.sermon-library-container * {
  box-sizing: border-box;
}

/* Section spacing */
.sermon-section {
  margin-bottom: 40px;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.sermon-section h2 {
  font-size: 1.5rem;
  font-weight: 600;
  margin: 0;
  color: #333;
}

/* Livestream */
.livestream-container {
  max-width: 900px;
  margin: 0 auto 40px;
}

.livestream-video {
  position: relative;
  padding-bottom: 56.25%;
  height: 0;
  overflow: hidden;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  background: #000;
}

.livestream-video iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: 0;
}

#placeholder {
  text-align: center;
  padding: 40px 20px;
  color: #666;
}

/* Grid Gallery - Simple responsive grid */
.gallery-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 24px;
  width: 100%;
}

@media (min-width: 768px) {
  .gallery-grid {
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  }
}

/* Horizontal scroll gallery - for recent sermons */
.scroll-wrapper {
  position: relative;
}

.gallery-scroll {
  display: grid;
  grid-auto-flow: column;
  grid-auto-columns: minmax(280px, 320px);
  gap: 24px;
  overflow-x: auto;
  overflow-y: hidden;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
  padding-bottom: 12px;
  scrollbar-width: thin;
  scrollbar-color: rgba(0,0,0,0.2) transparent;
  scroll-behavior: smooth;
}

.gallery-scroll::-webkit-scrollbar {
  height: 8px;
}

.gallery-scroll::-webkit-scrollbar-track {
  background: transparent;
}

.gallery-scroll::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
}

.gallery-scroll::-webkit-scrollbar-thumb:hover {
  background: rgba(0,0,0,0.3);
}

.gallery-scroll .thumbnail-card {
  scroll-snap-align: start;
}

/* Navigation arrows */
.scroll-nav {
  display: flex;
  gap: 8px;
}

.scroll-btn {
  background: white;
  border: 1px solid #ddd;
  border-radius: 50%;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.scroll-btn:hover {
  background: #f5f5f5;
  border-color: #999;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

.scroll-btn:active {
  transform: scale(0.95);
}

.scroll-btn .material-icons {
  font-size: 20px;
  color: #333;
}

@media (min-width: 768px) {
  .gallery-scroll {
    grid-auto-columns: minmax(320px, 360px);
  }
}

/* Mobile: Hide scrollbar */
@media (max-width: 767px) {
  .gallery-scroll {
    scrollbar-width: none;
  }

  .gallery-scroll::-webkit-scrollbar {
    display: none;
  }
}

/* Thumbnail card */
.thumbnail-card {
  position: relative;
  width: 100%;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.thumbnail-card:hover {
  transform: translateY(-4px);
}

.thumbnail-image-wrapper {
  position: relative;
  width: 100%;
  padding-bottom: 56.25%;
  overflow: hidden;
  background: #f0f0f0;
  border-radius: 8px;
}

.thumbnail-image {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: opacity 0.2s ease;
}

.thumbnail-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.2s ease;
  border-radius: 8px;
}

.thumbnail-card:hover .thumbnail-overlay {
  opacity: 1;
}

.overlay-text {
  color: white;
  font-size: 1.2rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.thumbnail-title {
  margin-top: 12px;
  font-size: 0.95rem;
  font-weight: 500;
  color: #333;
  line-height: 1.4;
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

/* Responsive adjustments */
@media (max-width: 480px) {
  .sermon-library-container {
    padding: 12px;
  }

  .sermon-section h2 {
    font-size: 1.25rem;
  }

  .gallery-grid {
    grid-template-columns: 1fr;
    gap: 16px;
  }
}
    </style>

</head>

<body>

    <div class="sermon-library-container">
        <div id="main">
            <!-- Content injected by script -->
        </div>
    </div>


    <!-- Templates -->
    <template id="livestream-section-template">
        <div class="sermon-section livestream-container">
            <h2>Live Stream</h2>
            <div id="placeholder">
                <p>Our livestream is available here every Sunday starting around 10:30am</p>
            </div>
            <template id="active_livestream-template">
                <div class="livestream-video">
                    <iframe
                        src="https://www.youtube.com/embed/live_stream?channel=UCC1I2rNY2tiUZUFft4SVj2A"
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                    </iframe>
                </div>
            </template>
        </div>
    </template>

    <template id="recent-sermons-template">
        <div class="sermon-section">
            <div class="section-header">
                <h2>Most Recent Sermons</h2>
                <div class="scroll-nav">
                    <button class="scroll-btn scroll-left" aria-label="Scroll left">
                        <span class="material-icons">chevron_left</span>
                    </button>
                    <button class="scroll-btn scroll-right" aria-label="Scroll right">
                        <span class="material-icons">chevron_right</span>
                    </button>
                </div>
            </div>
            <div id="recent-sermons-container" class="gallery-scroll"></div>
        </div>
    </template>

    <template id="recent-series-template">
        <div class="sermon-section">
            <h2>Most Recent Series</h2>
            <div id="recent-series-container" class="gallery-grid"></div>
        </div>
    </template>

    <template id="special-series-template">
        <div class="sermon-section">
            <h2>Special Series</h2>
            <div id="special-series-container" class="gallery-grid"></div>
        </div>
    </template>

    <template id="series-thumbnail-template">
        <div class="thumbnail-card">
            <div class="thumbnail-image-wrapper">
                <img class="thumbnail-image" src="" alt="">
                <div class="thumbnail-overlay">
                    <span class="overlay-text">Watch</span>
                </div>
            </div>
        </div>
    </template>

    <template id="video-thumbnail-template">
        <div class="thumbnail-card">
            <div class="thumbnail-image-wrapper">
                <img class="thumbnail-image" src="" alt="">
                <div class="thumbnail-overlay">
                    <span class="overlay-text">Watch</span>
                </div>
            </div>
            <div class="thumbnail-title">Title</div>
        </div>
    </template>


    <!-- Inline JavaScript -->
    <script>
// CONFIGURE THESE URLs to match your Squarespace pages
const SERIES_PAGE_URL = 'series.html'; // Change to '/sermons/series'
const VIDEO_PAGE_URL = 'video.html';   // Change to '/sermons/watch'

const API_BASE_URL = 'https://raw.githubusercontent.com/golfingmateo/rhnl/main/docs/data/';
const API_PLAYLIST = API_BASE_URL + 'playlists/';

async function fetchJson(url) {
    try {
        const response = await fetch(url);
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return await response.json();
    } catch (error){
        console.error('Error fetching data:', error);
    }
}

function showLivestream(){
    const hawaiiTime = new Date(
        new Date().toLocaleString("en-US", { timeZone: "Pacific/Honolulu" })
    );
    const day = hawaiiTime.getDay();
    const hours = hawaiiTime.getHours();
    const minutes = hawaiiTime.getMinutes();
    const currentTime = hours * 60 + minutes;
    const startTime = 10 * 60 + 30;
    const endTime = 12 * 60 + 30;
    return (day === 0 && currentTime >= startTime && currentTime <= endTime);
}

async function addSermonThumbnail(sermon, container, seriesFilename = null){
    const tmpl = document.getElementById("video-thumbnail-template");
    const clone = tmpl.content.cloneNode(true);

    const img = clone.querySelector(".thumbnail-image");
    img.src = sermon.thumbnail_url;
    img.alt = sermon.title;

    const title = clone.querySelector(".thumbnail-title");
    title.textContent = sermon.title;

    const card = clone.querySelector(".thumbnail-card");
    card.addEventListener("click", () => {
        const params = new URLSearchParams({
            videoId: sermon.video_id,
            title: sermon.title,
            thumbnail: sermon.thumbnail_url,
            description: sermon.description || ''
        });
        if (seriesFilename) {
            params.append('series', seriesFilename);
        }
        window.location.href = `${VIDEO_PAGE_URL}?${params.toString()}`;
    });

    container.appendChild(clone);
}

async function addSeriesThumbnail(seriesItem, container){
    const tmpl = document.getElementById("series-thumbnail-template");
    const clone = tmpl.content.cloneNode(true);

    const img = clone.querySelector(".thumbnail-image");
    img.src = API_BASE_URL + seriesItem.thumbnail_url;
    img.alt = seriesItem.title;

    const card = clone.querySelector(".thumbnail-card");
    card.addEventListener("click", () => {
        const params = new URLSearchParams({
            filename: seriesItem.filename,
            title: seriesItem.title
        });
        window.location.href = `${SERIES_PAGE_URL}?${params.toString()}`;
    });

    container.appendChild(clone);
}

async function populateRecentSermons(){
    const series = await fetchJson(API_BASE_URL + '/index.json');
    const most_recent = series.find(sermon => sermon.title === "Most Recent");
    if(!most_recent) {
        console.warn('No "Most Recent" series found.');
        return;
    }

    const container = document.getElementById("recent-sermons-container");
    const sermons = await fetchJson(API_PLAYLIST + most_recent.filename);
    sermons.forEach(sermon => {
        addSermonThumbnail(sermon, container, most_recent.filename);
    });
}

async function populateSeries(){
    const recent = document.getElementById("recent-series-container");
    const special = document.getElementById("special-series-container");
    const series = await fetchJson(API_BASE_URL + '/index.json');

    series.forEach(seriesItem => {
        if(seriesItem.title == "Most Recent") return;

        if(seriesItem.category == "Special Series"){
            addSeriesThumbnail(seriesItem, special);
        }else{
            addSeriesThumbnail(seriesItem, recent);
        }
    });
}

function setupScrollButtons() {
    const scrollLeft = document.querySelector('.scroll-left');
    const scrollRight = document.querySelector('.scroll-right');
    const scrollContainer = document.getElementById('recent-sermons-container');

    if (!scrollLeft || !scrollRight || !scrollContainer) return;

    scrollLeft.addEventListener('click', () => {
        const scrollAmount = scrollContainer.clientWidth * 0.8;
        scrollContainer.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
    });

    scrollRight.addEventListener('click', () => {
        const scrollAmount = scrollContainer.clientWidth * 0.8;
        scrollContainer.scrollBy({ left: scrollAmount, behavior: 'smooth' });
    });
}

async function initMainPage() {
    const main = document.getElementById("main");

    // Livestream section
    const live = document.getElementById("livestream-section-template").cloneNode(true);
    main.appendChild(live.content);

    if(showLivestream()){
        const container = document.querySelector(".livestream-container");
        const tmpl = document.getElementById("active_livestream-template");
        const clone = tmpl.content.cloneNode(true);
        container.appendChild(clone);
        document.getElementById("placeholder").hidden = true;
    }

    // Recent sermons
    const recentSermons = document.getElementById("recent-sermons-template").content.cloneNode(true);
    main.appendChild(recentSermons);
    populateRecentSermons();

    // Setup scroll buttons after sermons are loaded
    setTimeout(setupScrollButtons, 500);

    // Series sections
    const recent = document.getElementById("recent-series-template").content.cloneNode(true);
    const special = document.getElementById("special-series-template").content.cloneNode(true);
    main.appendChild(recent);
    main.appendChild(special);
    populateSeries();
}

document.addEventListener('DOMContentLoaded', function() {
    initMainPage();
});
    </script>

</body>
</html>
